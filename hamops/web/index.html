<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hamops â€“ Amateur Radio Operations Center</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="icon" type="image/svg+xml" href="/web/logo.svg">
  <link rel="stylesheet" href="/web/styles.css">
</head>
<body>
  <!-- Header -->
  <header>
    <div class="header-content">
      <a href="/" class="logo">
        <img src="/web/logo.svg" alt="Hamops" />
        <h1>Hamops</h1>
      </a>
      <nav class="nav-links">
        <a href="/docs" class="nav-link">API Docs</a>
        <a href="/mcp" class="nav-link">MCP</a>
        <a href="/health" class="nav-link">Status</a>
        <a href="https://github.com/domcritchlow/hamops" class="nav-link">GitHub</a>
      </nav>
    </div>
  </header>

  <!-- Main Content -->
  <div class="container">
    <div class="page-header">
      <h2 class="page-title">Amateur Radio Operations Center</h2>
      <p class="page-subtitle">Query callsigns, APRS data, and US band plans through REST APIs and MCP</p>
    </div>

    <!-- Callsign Services -->
    <div class="service-section">
      <div class="section-header">
        <span class="section-icon">ðŸ“»</span>
        <h3 class="section-title">Callsign Services</h3>
      </div>
      
      <div class="service-item">
        <div class="service-header-row">
          <div class="service-info">
            <div class="service-name">Callsign Lookup</div>
            <div class="service-description">Look up FCC registration data including license class, location, and expiration</div>
            <div class="service-endpoint">GET /api/callsign/{callsign}</div>
          </div>
        </div>
        <div class="service-controls">
          <input type="text" class="input" id="callsign-input" placeholder="Enter callsign (e.g., KK4ZMR)" />
          <button class="btn" data-service="callsign">Query</button>
        </div>
        <div class="result" id="callsign-result"></div>
      </div>
    </div>

    <!-- APRS Services -->
    <div class="service-section">
      <div class="section-header">
        <span class="section-icon">ðŸ“¡</span>
        <h3 class="section-title">APRS Services</h3>
      </div>
      
      <div class="service-item">
        <div class="service-header-row">
          <div class="service-info">
            <div class="service-name">APRS Locations</div>
            <div class="service-description">Retrieve latest position reports with speed, altitude, and path information</div>
            <div class="service-endpoint">GET /api/aprs/locations/{callsign}</div>
          </div>
        </div>
        <div class="service-controls">
          <input type="text" class="input" id="aprs-location-input" placeholder="Enter callsign (e.g., KD4PMP)" />
          <button class="btn" data-service="aprs-location">Query</button>
        </div>
        <div class="result" id="aprs-location-result"></div>
      </div>

      <div class="service-item">
        <div class="service-header-row">
          <div class="service-info">
            <div class="service-name">APRS Weather</div>
            <div class="service-description">Get current weather conditions from APRS weather stations</div>
            <div class="service-endpoint">GET /api/aprs/weather/{callsign}</div>
          </div>
        </div>
        <div class="service-controls">
          <input type="text" class="input" id="aprs-weather-input" placeholder="Enter callsign (e.g., KD4PMP)" />
          <button class="btn" data-service="aprs-weather">Query</button>
        </div>
        <div class="result" id="aprs-weather-result"></div>
      </div>

      <div class="service-item">
        <div class="service-header-row">
          <div class="service-info">
            <div class="service-name">APRS Messages</div>
            <div class="service-description">Fetch APRS text messages sent to or from a callsign</div>
            <div class="service-endpoint">GET /api/aprs/messages/{callsign}</div>
          </div>
        </div>
        <div class="service-controls">
          <input type="text" class="input" id="aprs-messages-input" placeholder="Enter callsign" />
          <button class="btn" data-service="aprs-messages">Query</button>
        </div>
        <div class="result" id="aprs-messages-result"></div>
      </div>
    </div>

    <!-- Band Plan Services -->
    <div class="service-section">
      <div class="section-header">
        <span class="section-icon">ðŸ“Š</span>
        <h3 class="section-title">Band Plan Services</h3>
      </div>
      
      <div class="service-item">
        <div class="service-header-row">
          <div class="service-info">
            <div class="service-name">Band at Frequency</div>
            <div class="service-description">Find band allocations, modes, and license privileges at any frequency</div>
            <div class="service-endpoint">GET /api/bands/frequency/{frequency}</div>
          </div>
        </div>
        <div class="service-controls">
          <input type="text" class="input" id="band-frequency-input" placeholder="Enter frequency (e.g., 14.225 MHz, 146.52 MHz)" />
          <button class="btn" data-service="band-frequency">Query</button>
        </div>
        <div class="result" id="band-frequency-result"></div>
      </div>

      <div class="service-item">
        <div class="service-header-row">
          <div class="service-info">
            <div class="service-name">Search Bands</div>
            <div class="service-description">Search the US band plan by mode, band name, license class, or typical use</div>
            <div class="service-endpoint">GET /api/bands/search</div>
          </div>
        </div>
        <div class="service-controls">
          <div class="two-column">
            <select class="input" id="band-search-mode">
              <option value="">Any Mode</option>
              <option value="CW">CW</option>
              <option value="USB">USB</option>
              <option value="LSB">LSB</option>
              <option value="FM">FM</option>
              <option value="AM">AM</option>
              <option value="DIGITAL">Digital</option>
            </select>
            <select class="input" id="band-search-band">
              <option value="">Any Band</option>
              <option value="160m">160m</option>
              <option value="80m">80m</option>
              <option value="40m">40m</option>
              <option value="30m">30m</option>
              <option value="20m">20m</option>
              <option value="17m">17m</option>
              <option value="15m">15m</option>
              <option value="12m">12m</option>
              <option value="10m">10m</option>
              <option value="6m">6m</option>
              <option value="2m">2m</option>
              <option value="70cm">70cm</option>
            </select>
          </div>
          <select class="input" id="band-search-license">
            <option value="">Any License</option>
            <option value="Technician">Technician</option>
            <option value="General">General</option>
            <option value="Advanced">Advanced</option>
            <option value="Extra">Extra</option>
          </select>
          <button class="btn" data-service="band-search">Query</button>
        </div>
        <div class="result" id="band-search-result"></div>
      </div>

      <div class="service-item">
        <div class="service-header-row">
          <div class="service-info">
            <div class="service-name">Bands in Range</div>
            <div class="service-description">Find all band allocations within a frequency range</div>
            <div class="service-endpoint">GET /api/bands/range/{start}/{end}</div>
          </div>
        </div>
        <div class="service-controls">
          <div class="input-row">
            <input type="text" class="input" id="band-range-start" placeholder="Start (e.g., 14 MHz)" />
            <input type="text" class="input" id="band-range-end" placeholder="End (e.g., 14.350 MHz)" />
          </div>
          <button class="btn" data-service="band-range">Query</button>
        </div>
        <div class="result" id="band-range-result"></div>
      </div>

      <div class="service-item">
        <div class="service-header-row">
          <div class="service-info">
            <div class="service-name">Band Plan Summary</div>
            <div class="service-description">Get metadata about the loaded band plan including version and coverage</div>
            <div class="service-endpoint">GET /api/bands/summary</div>
          </div>
        </div>
        <div class="service-controls">
          <button class="btn" data-service="band-summary">Query</button>
        </div>
        <div class="result" id="band-summary-result"></div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="footer-content">
      <div class="footer-links">
        <a href="/docs">API Documentation</a>
        <a href="/mcp">MCP Protocol</a>
        <a href="https://github.com/domcritchlow/hamops">Source Code</a>
        <a href="/health">System Status</a>
      </div>
      <div>&copy; 2025 Hamops Â· Open Source Amateur Radio APIs</div>
    </div>
  </footer>

  <script>
    // Service configurations
    const services = {
      'callsign': {
        endpoint: (input) => `/api/callsign/${input}`,
        inputId: 'callsign-input',
        resultId: 'callsign-result'
      },
      'aprs-location': {
        endpoint: (input) => `/api/aprs/locations/${input}`,
        inputId: 'aprs-location-input',
        resultId: 'aprs-location-result'
      },
      'aprs-weather': {
        endpoint: (input) => `/api/aprs/weather/${input}`,
        inputId: 'aprs-weather-input',
        resultId: 'aprs-weather-result'
      },
      'aprs-messages': {
        endpoint: (input) => `/api/aprs/messages/${input}`,
        inputId: 'aprs-messages-input',
        resultId: 'aprs-messages-result'
      },
      'band-frequency': {
        endpoint: (input) => `/api/bands/frequency/${encodeURIComponent(input)}`,
        inputId: 'band-frequency-input',
        resultId: 'band-frequency-result'
      },
      'band-search': {
        endpoint: () => {
          const mode = document.getElementById('band-search-mode').value;
          const band = document.getElementById('band-search-band').value;
          const license = document.getElementById('band-search-license').value;
          const params = new URLSearchParams();
          if (mode) params.append('mode', mode);
          if (band) params.append('band_name', band);
          if (license) params.append('license_class', license);
          return `/api/bands/search?${params.toString()}`;
        },
        resultId: 'band-search-result',
        noInput: true
      },
      'band-range': {
        endpoint: () => {
          const start = document.getElementById('band-range-start').value;
          const end = document.getElementById('band-range-end').value;
          if (!start || !end) {
            throw new Error('Please enter both start and end frequencies');
          }
          return `/api/bands/range/${encodeURIComponent(start)}/${encodeURIComponent(end)}`;
        },
        resultId: 'band-range-result',
        noInput: true
      },
      'band-summary': {
        endpoint: () => `/api/bands/summary`,
        resultId: 'band-summary-result',
        noInput: true
      }
    };

    // Query service function
    async function queryService(serviceId) {
      const service = services[serviceId];
      const resultElement = document.getElementById(service.resultId);
      
      try {
        // Get endpoint
        let endpoint;
        if (service.noInput) {
          endpoint = service.endpoint();
        } else {
          const input = document.getElementById(service.inputId).value.trim();
          if (!input) {
            showError(resultElement, 'Please enter a value');
            return;
          }
          endpoint = service.endpoint(input);
        }

        // Show loading
        showLoading(resultElement);

        // Make request
        const response = await fetch(endpoint);
        const data = await response.json();

        // Show result
        if (response.ok) {
          showResult(resultElement, data);
        } else {
          showError(resultElement, data.detail || 'An error occurred');
        }
      } catch (error) {
        showError(resultElement, error.message || 'Error fetching data');
      }
    }

    function showLoading(element) {
      element.innerHTML = '<div class="loading"><div class="spinner"></div> Loading...</div>';
      element.classList.add('active');
    }

    function showResult(element, data) {
      element.innerHTML = `<div class="result-content"><pre>${JSON.stringify(data, null, 2)}</pre></div>`;
      element.classList.add('active');
    }

    function showError(element, message) {
      element.innerHTML = `<div class="error">Error: ${message}</div>`;
      element.classList.add('active');
    }

    // Event listeners
    document.addEventListener('DOMContentLoaded', () => {
      // Button click handlers
      document.querySelectorAll('.btn[data-service]').forEach(button => {
        button.addEventListener('click', () => {
          queryService(button.dataset.service);
        });
      });

      // Enter key support for all inputs
      document.querySelectorAll('.input').forEach(input => {
        input.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            // Find the closest service item and its button
            const serviceItem = input.closest('.service-item');
            if (serviceItem) {
              const button = serviceItem.querySelector('.btn[data-service]');
              if (button) {
                button.click();
              }
            }
          }
        });
      });

      // Auto-focus first input when clicking service item
      document.querySelectorAll('.service-item').forEach(item => {
        item.addEventListener('click', (e) => {
          // Don't focus if clicking on input or button
          if (e.target.matches('input, button, select')) return;
          
          const firstInput = item.querySelector('input, select');
          if (firstInput) {
            firstInput.focus();
          }
        });
      });
    });
  </script>
</body>
</html>
